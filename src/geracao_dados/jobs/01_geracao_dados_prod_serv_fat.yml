resources:
  jobs:
    Data_Warehousing_1_Gera_dados_de_produtos_servicos_e_faturamento:
      name: "[Data Warehousing][1] Gera dados de produtos, servi√ßos e faturamento"
      tasks:
        - task_key: product_subscriptions
          notebook_task:
            notebook_path: ../tables/raw_tables/product_subscriptions.py
            base_parameters:
              p_schema: ${resources.schemas.customer_bronze.name}
              p_schema_misc: ${resources.schemas.misc.name}
            source: WORKSPACE
          environment_key: databricks_telecom_bundle          
        - task_key: sva_subscriptions
          depends_on:
            - task_key: product_subscriptions
          notebook_task:
            notebook_path: ../tables/raw_tables/sva_subscriptions.py
            base_parameters:
              p_schema: ${resources.schemas.customer_bronze.name}
              p_schema_misc: ${resources.schemas.misc.name}
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: invoicing
          depends_on:
            - task_key: sva_subscriptions
          notebook_task:
            notebook_path: ../tables/raw_tables/invoicing.py
            base_parameters:
              p_schema: ${resources.schemas.billing_bronze.name}
              p_schema_customer_bronze: ${resources.schemas.customer_bronze.name}
              p_schema_misc: ${resources.schemas.misc.name}
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
      environments:
        - environment_key: databricks_telecom_bundle
          spec:
            client: "2"
            dependencies:
              - Faker==28.4.1
              - dbldatagen==0.4.0.post1
      performance_target: PERFORMANCE_OPTIMIZED
      tags:
        cost_center: "100.001"
        domain: misc
        env: prod
        project: geral
        uc_name: Geracao de Dados
        uc_step: "0"
      queue:
        enabled: true
      parameters:
        - name: p_catalog
          default: ${var.catalog_name}
        - name: p_data_schema
          default: ${resources.schemas.ingestion.name}
