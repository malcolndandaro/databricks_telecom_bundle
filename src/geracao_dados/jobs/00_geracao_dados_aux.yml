resources:
  jobs:
    Geracao_de_Dados_0_Gera_tabelas_que_auxiliam_a_geracao_de_dados:
      name: "[Geracao de Dados] [0] Gera tabelas que auxiliam a Geracao de dados"
      tasks:
        - task_key: datalake_structure_uc_volumes
          notebook_task:
            notebook_path:  ../volumes/datalake_and_UC_volumes.py
            base_parameters:
              p_schema: ingestion
              p_volume: raw_data
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_municipios
          depends_on:
            - task_key: datalake_structure_uc_volumes
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_tbl_municipios.py
            base_parameters:
              p_schema: misc
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_functions_-_address
          depends_on:
            - task_key: aux_tables_-_municipios
          notebook_task:
            notebook_path: ../tables/aux_functions/address.py
            base_parameters:
              p_schema: misc
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_produtos
          depends_on:
            - task_key: datalake_structure_uc_volumes
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_tbl_produtos.py
            base_parameters:
              p_schema: misc
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_servicos
          depends_on:
            - task_key: datalake_structure_uc_volumes
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_tbl_servi√ßos.py
            base_parameters:
              p_schema: misc
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_clientes
          depends_on:
            - task_key: aux_functions_-_address
            - task_key: aux_tables_-_produtos
            - task_key: aux_tables_-_servicos
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_tbl_clientes.py
            base_parameters:
              p_schema: misc
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_erb_carga
          depends_on:
            - task_key: aux_tables_-_clientes
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_erb_carga.py
            base_parameters:
              catalog_name: ${var.catalog_name}
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_enderecos
          depends_on:
            - task_key: aux_tables_-_erb_carga
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_enderecos.py
            base_parameters:
              catalog_name: ${var.catalog_name}
              num_address: "40"
              max_distance_erb: "3"
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
        - task_key: aux_tables_-_base_antena_casa
          depends_on:
            - task_key: aux_tables_-_enderecos
          notebook_task:
            notebook_path: ../tables/aux_tables/aux_base_antena_casa.py
            base_parameters:
              catalog_name: ${var.catalog_name}
              begin_time_home: "0"
              end_time_home: "6"
              data_ref: "2024-10-01 00:00:00"
              qt_GB_month: "25"
              amostra: "False"
            source: WORKSPACE
          environment_key: databricks_telecom_bundle
      environments:
        - environment_key: databricks_telecom_bundle
          spec:
            client: "2"
            dependencies:
              - Faker==28.4.1
              - dbldatagen==0.4.0.post1
              - faiss-cpu==1.8.0.post1
      performance_target: OPTIMIZED
      tags:
        cost_center: "100.001"
        domain: misc
        env: prod
        project: geral
        uc_name: Geracao de Dados
        uc_step: "0"
      queue:
        enabled: true
      parameters:
        - name: p_catalog
          default: ${var.catalog_name}
